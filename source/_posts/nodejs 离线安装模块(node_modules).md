title: nodejs 离线安装模块(node_modules)
date: 2015-10-27 00:00:00 #发表日期，一般不改动
categories: nodejs #文章文类
tags: [nodejs,ionic] #文章标签，多于一项时用这种格式
photos:


---


# 查看自己npm的安装路径 
查看: `npm root   -g `
结果: `C:\Users\Administrator\AppData\Roaming\npm`


查看: `cnpm root   -g `
结果: `C:\Program Files\nodejs\node_modules`


# 检查配置 path环境变量:
`C:\Users\Administrator\AppData\Roaming\npm`
(安装nodejs时会默认添加到用户变量的path)


# 将备份的离线`node_modules`还原到相应目录:
示例-ionic:
```
C:\Users\Administrator\AppData\Roaming\npm\node_modules\ionic
C:\Users\Administrator\AppData\Roaming\npm\ionic.cmd
```


# 测试
`ionic -v`
<!-- more -->


# 可能出现的错误:
```
 C:\Users\Administrator>ionic -version
module.js:339
    throw err;
    ^

Error: Cannot find module 'process-nextick-args'
    at Function.Module._resolveFilename (module.js:337:15)
    at Function.Module._load (module.js:287:25)
    at Module.require (module.js:366:17)
    at require (module.js:385:17)
    at Object.<anonymous> (C:\Users\Administrator\AppData\Roaming\npm\node_modules\ionic\node_modules\ionic-app-lib\node_modules\vinyl-fs\node_modules\glob-stream\node_modules\unique-stream\node_modules\through2-filter\node_modules\through2\node_modules\readable-stream\lib\_stream_duplex.js:20:23)
    at Module._compile (module.js:425:26)
    at Object.Module._extensions..js (module.js:432:10)
    at Module.load (module.js:356:32)
    at Function.Module._load (module.js:311:12)
    at Module.require (module.js:366:17)
    at require (module.js:385:17) 
```
原因是 cnpm 依赖模块未安装.


解决办法:
```
cnpm sync process-nextick-args

cnpm  sync  core-util-is
cnpm  sync  inherits
cnpm  sync  isarray
目标路径:
C:\Program Files\nodejs\node_modules\npm\node_modules\npm-registry-client\node_modules\concat-stream\node_modules\readable-stream\node_modules\process-nextick-args

C:\Program Files\nodejs\node_modules\npm\node_modules\request\node_modules\bl\node_modules\readable-stream\node_modules\process-nextick-args



或(当前目录安装)
cnpm install process-nextick-args
cnpm install core-util-is
cnpm install inherits
cnpm install isarray

目标路径: 当前目录下 node_modules

```

# 安装了cnpm,离线安装(或恢复)模块

查看: ` cnpm root -g `

结果: `C:\Program Files\nodejs\node_modules `


```
未指定全局目录,会安装在当前目录下,如
npm --registry=http://r.cnpmjs.org install cnpm

C:\Users\Administrator\node_modules\cnpm



全局目录,会安装在node公共目录下,如

npm --registry=http://r.cnpmjs.org install cnpm -g
C:\Users\Administrator\AppData\Roaming\npm\node_modules\cnpm



[cnpm info connect |  cnpm info connect -g] ,会在当前目录生成.cnpm描述文件(仅package.json)
C:\Users\Administrator\.cnpm
模块版本登记? 批量安装恢复?  作用未知? 


默认cmd安装目录 :  C:\Users\Administrator\node_modules
node全局安装目录: C:\Program Files\nodejs\node_modules\npm\node_modules

```


参考文章:
`快速搭建 Node.js 开发环境以及加速 npm`
http://segmentfault.com/a/1190000000454456


